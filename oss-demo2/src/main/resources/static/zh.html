<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" name="referrer" content="no-referrer" />
    <title>Title</title>
    <script src="jquery-3.3.1.min.js"></script>
</head>
<script type="text/javascript">
    var pre = 'https://lxpupload2.oss-cn-beijing.aliyuncs.com/';
    $(function () {
        listfile();
    });

    //文件列表
    function listfile() {
        $.ajax({
            url: "http://localhost:8080/file/list",
            type: 'POST',
            success: function (rtn) {
                console.log(rtn.length);
                for (var i = 0; i < rtn.length; i++) {
                    $('div').append('<img src="' + pre + rtn[i].fileName + '" style="width: 300px;height: 300px; padding: 10px" ondblclick="deletefile(this.src,'+rtn[i].id+')" onclick="downloadfile(this.src)"></img>')
                }
            }
        });
    }

    //文件下载
    function downloadfile(src) {
        var fileName = src.split(pre)[1];
        window.location.href = "http://localhost:8080/file/download?fileName=" + fileName;
    }

    //文件删除
    function deletefile(src,id) {
        var fileName = src.split(pre)[1];
        var param = {fileName: fileName};
        $.ajax({
            url: "http://localhost:8080/file/delete?id="+id,
            data: param,
            success: function () {
                alert('删除成功',fileName);
                //删除页面
                location.reload();
            }
        });
    }
</script>
<body>
<h3>单击下载oss上的图片、双击删除oss上的图片</h3><br>
<div>
</div>
</body>
</html>
